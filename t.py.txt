for rd in risk_drivers.risk_driver.unique():
    print(rd)
    
    # Convert the relevant columns to string type to ensure consistency for merging
    cohort_data[rd.lower()] = cohort_data[rd.lower()].astype(str)
    risk_drivers['level'] = risk_drivers['level'].astype(str)

    # Perform the merge and create the new column
    cohort_data[rd.upper() + "_NUM"] = cohort_data[[rd.lower()]].merge(
        risk_drivers[risk_drivers.risk_driver.str.match(rd)], 
        how="left", 
        left_on=rd.lower(), 
        right_on="level"
    )['value']

    # Optionally, handle NaN values (if needed)
    cohort_data[rd.upper() + "_NUM"] = cohort_data[rd.upper() + "_NUM"].fillna(0)
