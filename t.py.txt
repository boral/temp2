import pandas as pd

# Define variables
model = "HF"
matchpctchar = 100
rundt = "29APR2024"

# Load data from a file (adjust file path as needed)
orig_scope = pd.read_csv(f'new_hf/scopedata_lean_{model}_{rundt}_{matchpctchar}.csv')

# Keep specified columns and add 'model' column
orig_scope = orig_scope[['gcdu_global_id', 'carm_type', 'carm_flag', 'gra_flag', 'customer_name']].copy()
orig_scope['model'] = model

# Frequency count for 'carm_flag' and 'carm_type'
freq_table = pd.crosstab(orig_scope['carm_flag'], orig_scope['carm_type'], margins=True, dropna=False)
print(freq_table)

# Filter for CFCONLY
cfc_scope = orig_scope[orig_scope['carm_flag'] == "CFCONLY"]

# Filter for CFB
cfb_scope = orig_scope[orig_scope['carm_type'] == "CFB"]
