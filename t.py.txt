def gra_assessment_cfc(in_data, matchpct, portfolio):
    import pandas as pd

    data = pd.DataFrame(in_data)
    data['GRA_ASSESSMENT'] = ""
    data['GRA_FLAG'] = ""

    for index, row in data.iterrows():
        if row['MODEL_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Both Scorecards and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = portfolio
        elif row['MODEL_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = f"{portfolio} (check SIC code)"
        elif row['MODEL_SCORECARD_PCT'] < matchpct and row['MODEL_SCORECARD_PCT'] > 0 and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards partially and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] < matchpct and row['MODEL_SCORECARD_PCT'] > 0 and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Both Scorecards and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] <= 0 and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Never rated with {portfolio} and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] <= 0 and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Never rated with {portfolio} and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        else:
            data.at[index, 'GRA_ASSESSMENT'] = "Other issues"
            data.at[index, 'GRA_FLAG'] = "Inconclusive"

        if portfolio == "HedgeFund" and row['SECOND_MAX_SCORECARD_TYPE'] == "FundofFund":
            if row['SECOND_MAX_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] == 1:
                data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully aligned with {row['SECOND_MAX_SCORECARD_TYPE']} and SIC Codes fully aligned with {portfolio}."
                data.at[index, 'GRA_FLAG'] = "FundofFund"
            elif row['SECOND_MAX_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] < 1:
                data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully aligned with {row['SECOND_MAX_SCORECARD_TYPE']} and SIC Codes partially aligned with {portfolio}."
                data.at[index, 'GRA_FLAG'] = "FundofFund (check SIC code)"

    return data


def gra_assessment_cfb(in_data, matchpct, portfolio):
    import pandas as pd

    data = pd.DataFrame(in_data)
    data['GRA_ASSESSMENT'] = ""
    data['GRA_FLAG'] = ""

    for index, row in data.iterrows():
        if row['MODEL_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Both Scorecards and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = portfolio
        elif row['MODEL_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = f"{portfolio} (check SIC code)"
        elif row['MODEL_SCORECARD_PCT'] < matchpct and row['MODEL_SCORECARD_PCT'] > 0 and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards partially and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] < matchpct and row['MODEL_SCORECARD_PCT'] > 0 and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Both Scorecards and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] <= 0 and row['MODEL_SIC_PCT'] == 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Never rated with {portfolio} and SIC Codes fully aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        elif row['MODEL_SCORECARD_PCT'] <= 0 and row['MODEL_SIC_PCT'] < 1:
            data.at[index, 'GRA_ASSESSMENT'] = f"Never rated with {portfolio} and SIC Codes partially aligned with {portfolio}."
            data.at[index, 'GRA_FLAG'] = "Inconclusive"
        else:
            data.at[index, 'GRA_ASSESSMENT'] = "Other issues"
            data.at[index, 'GRA_FLAG'] = "Inconclusive"

        if portfolio == "HedgeFund" and row['SECOND_MAX_SCORECARD_TYPE'] == "FundofFund":
            if row['SECOND_MAX_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] == 1:
                data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully aligned with {row['SECOND_MAX_SCORECARD_TYPE']} and SIC Codes fully aligned with {portfolio}."
                data.at[index, 'GRA_FLAG'] = "FundofFund"
            elif row['SECOND_MAX_SCORECARD_PCT'] >= matchpct and row['MODEL_SIC_PCT'] < 1:
                data.at[index, 'GRA_ASSESSMENT'] = f"Scorecards fully aligned with {row['SECOND_MAX_SCORECARD_TYPE']} and SIC Codes partially aligned with {portfolio}."
                data.at[index, 'GRA_FLAG'] = "FundofFund (check SIC code)"

    return data
