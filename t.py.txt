def apl_history(in_data, apl_data, out):
    import pandas as pd

    # Remove duplicates by 'gcdu_global_id'
    temp_apl_hist = in_data.drop_duplicates(subset='gcdu_global_id')

    # Inner join on 'gcdu_global_id'
    out_data = pd.merge(apl_data, temp_apl_hist[['gcdu_global_id']], on='gcdu_global_id', how='inner')

    # Save the output
    out_data.to_csv(out, index=False)
